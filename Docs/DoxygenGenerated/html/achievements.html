<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CotC C# SDK for Unity: Working with achievements</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="OutputCustomization.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xtralife-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CotC C# SDK for Unity
   &#160;<span id="projectnumber">v1.4.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Working with achievements </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>CotC provides a platform independent way of handling achievements for your game. Note that <b>achievements need to be defined on the backoffice</b> before being used on the client.</p>
<p>This page is aimed at being a little tutorial on how to work with achievements from the SDK (client). For the next steps, we will suppose that you already know how to create achievements from the backoffice. For a complete list of useful functions in the SDK, take a look at <a class="el" href="class_cotc_sdk_1_1_gamer_achievements.html">CotcSdk.GamerAchievements</a>.</p>
<h2>Querying the progress of the gamer </h2>
<p>Fetching the state of achievements is a function that require the customer to be logged in. In general, the status of achievements represents an association between a gamer and a game.</p>
<p>The call that we are going to use is <a class="el" href="class_cotc_sdk_1_1_gamer_achievements.html#a3068ff18569430ec9528443c81084e26" title="Fetches information about the status of the achievements configured for this game.">CotcSdk.GamerAchievements.List</a>. An example is shown below, we'll create UI buttons with information about each achievement. The GUI toolkit is virtual, and you may want to implement additional features such as pagination.</p>
<div class="fragment"><div class="line">gamer.Achievements.List()</div><div class="line">.Done(achievements =&gt; {</div><div class="line">    <span class="keywordflow">foreach</span> (var pair <span class="keywordflow">in</span> achievements) {</div><div class="line">        <span class="keywordtype">string</span> achName = pair.Key;</div><div class="line">        AchievementDefinition ach = pair.Value;</div><div class="line"></div><div class="line">        Gui.Button button = CreateButton();</div><div class="line">        button.ProgressPercent = ach.Progress * 100;</div><div class="line">        </div><div class="line">        <span class="comment">// You can put additional data in the definition (&#39;gameData&#39; node)</span></div><div class="line">        <span class="comment">// Here we use that to hide some achievements by default and reveal them</span></div><div class="line">        <span class="comment">// explicitely by storing a property in the &#39;gamerData&#39; (for the gamer)</span></div><div class="line">        <span class="keywordtype">bool</span> hiddenUnlessUnlocked = ach.GameData[<span class="stringliteral">&quot;initiallyHidden&quot;</span>];</div><div class="line">        <span class="keywordtype">bool</span> revealedByGamer = ach.GamerData[<span class="stringliteral">&quot;unhidden&quot;</span>];</div><div class="line">        <span class="comment">// Do not show hidden achievements</span></div><div class="line">        <span class="keywordflow">if</span> (hiddenUnlessUnlocked &amp;&amp; !revealedByGamer)</div><div class="line">            <span class="keywordflow">continue</span>;</div><div class="line">        </div><div class="line">        <span class="comment">// Some data can be displayed depending on the achievement name (used as an unique identifier)</span></div><div class="line">        <span class="keywordflow">if</span> (pair.Key == <span class="stringliteral">&quot;supersonic&quot;</span>) {</div><div class="line">            <span class="comment">// Display your text, potentially localized based on the state of the gamer</span></div><div class="line">            button.Title = <span class="stringliteral">&quot;Supersonic runner!&quot;</span>;</div><div class="line">            <span class="keywordflow">if</span> (ach.Progress &gt;= 1)</div><div class="line">                button.Subtitle = <span class="stringliteral">&quot;Achievement obtained because you rock!&quot;</span>;</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">                button.Subtitle = <span class="stringliteral">&quot;Finish the game in under one hour!&quot;</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">});</div></div><!-- fragment --><h2>Notifying progress </h2>
<p>If you have configured your achievements through the backoffice, you know that achievements are triggered when so-called units reach a certain value. This means that to trigger an achievement, you will increase the value of an unit by using a transaction. Let's consider the following transaction on the server:</p>
<div class="fragment"><div class="line">&quot;supersonic&quot; {</div><div class="line">    &quot;type&quot;: &quot;limit&quot;,</div><div class="line">    &quot;config&quot;: {</div><div class="line">        &quot;unit&quot;: &quot;supersonic&quot;,</div><div class="line">        &quot;maxValue&quot;: 1</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If you want to trigger that achievement, you will simply do a transaction for this unit:</p>
<div class="fragment"><div class="line">gamer.Transactions.Post(Bundle.CreateObject(<span class="stringliteral">&quot;supersonic&quot;</span>, +1))</div><div class="line">.Done(txResult =&gt; {</div><div class="line">    Debug.Log(txResult.TriggeredAchievements.Count); <span class="comment">// 1</span></div><div class="line">}</div></div><!-- fragment --><h2>Domains </h2>
<p>By default, achievements use the key/value storage associated with the private domain (that is, reserved for this game). You may create achievement on different domains, in which case they refer to units posted in the corresponding domain.</p>
<h2>Associating user data with an achievement </h2>
<p>Arbitrary data can be associated for an user and an achievement by using the <a class="el" href="class_cotc_sdk_1_1_gamer_achievements.html#a3b88ee3dae586c54203cc28173818746" title="Allows to store arbitrary data for a given achievement and the current player (appears in the &#39;gamerD...">CotcSdk.GamerAchievements.AssociateData</a> API call. For instance, this could be used to store any useful detail on how the gamer was realized. The following example describes yet another use case: we want to unhide an achievement that has been marked as hidden by default and not listed in the section above.</p>
<div class="fragment"><div class="line">gamer.Transactions.Post(Bundle.CreateObject(<span class="stringliteral">&quot;supersonic&quot;</span>, +1))</div><div class="line">.Then(txResult =&gt; {</div><div class="line">    <span class="comment">// Achievement triggered =&gt; associate data</span></div><div class="line">    <span class="keywordflow">if</span> (txResult.TriggeredAchievements.ContainsKey(<span class="stringliteral">&quot;supersonic&quot;</span>)) {</div><div class="line">        <span class="keywordflow">return</span> gamer.Achievements.AssociateData(<span class="stringliteral">&quot;supersonic&quot;</span>, Bundle.CreateObject(<span class="stringliteral">&quot;unhidden&quot;</span>, <span class="keyword">true</span>));</div><div class="line">    }</div><div class="line">})</div><div class="line">.Done();</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 7 2019 11:30:47 for CotC C# SDK for Unity by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
